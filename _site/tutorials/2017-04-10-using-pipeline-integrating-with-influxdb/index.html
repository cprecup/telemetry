

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>            Using Pipeline: Integrating with InfluxDB      IOS XR Streaming Telemetry @xrdocs      </title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="IOS XR Streaming Telemetry @xrdocs">
<meta property="og:title" content="Using Pipeline: Integrating with InfluxDB">


  <link rel="canonical" href="https://xrdocs.github.io/telemetry/tutorials/2017-04-10-using-pipeline-integrating-with-influxdb/">
  <meta property="og:url" content="https://xrdocs.github.io/telemetry/tutorials/2017-04-10-using-pipeline-integrating-with-influxdb/">



  <meta property="og:description" content="Describes how to configure Pipeline to relay telemetry data to InfluxDB.">



  <meta name="twitter:site" content="@xrdocs">
  <meta name="twitter:title" content="Using Pipeline: Integrating with InfluxDB">
  <meta name="twitter:description" content="Describes how to configure Pipeline to relay telemetry data to InfluxDB.">
  <meta name="twitter:url" content="https://xrdocs.github.io/tutorials/2017-04-10-using-pipeline-integrating-with-influxdb/">

  
    <meta name="twitter:card" content="summary">
    
      <meta name="twitter:image" content="https://xrdocs.github.io/telemetry/images/telemetry-xrdocs.jpg">
    
  

  
    <meta name="twitter:creator" content="@scadora">
  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-04-10T20:19:00+00:00">
  
    <link rel="next" href="https://xrdocs.github.io/telemetry/tutorials/2017-05-05-mdt-with-grpc-transport-tricks/" title="MDT with gRPC: Transport Tricks">
  
  
    <link rel="prev" href="https://xrdocs.github.io/telemetry/tutorials/2016-10-03-pipeline-to-text-tutorial/" title="Using Pipeline: TCP to textfile">
  



  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "url": "https://xrdocs.github.io/telemetry",
      "logo": "https://xrdocs.github.io/telemetry/images/telemetry-xrdocs.jpg"
    }
  </script>



  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "person",
      "name" : "Cisco Systems Inc",
      "url" : "https://xrdocs.github.io/telemetry",
      "sameAs" : ["https://twitter.com/CiscoDevNet"]
    }
  </script>






<!-- end SEO -->

<link href="https://xrdocs.github.io/telemetry/feed.xml" type="application/atom+xml" rel="alternate" title="IOS XR Streaming Telemetry @xrdocs Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="google-site-verification" content="jgRKKm6B9FwJJPXxpmc0-EP3D0Mh8JHXaJqoYIGj1ek" />

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<script>
if (!(window.location.host.startsWith("127.0.0.1") || window.location.host.startsWith("localhost")) && (window.location.host.substr(-10) == '.github.io') && (window.location.protocol != "https:"))
    window.location.protocol = "https";
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/telemetry/assets/css/main.css">
<meta http-equiv="cleartype" content="on">
<style>
.underline-on-hover:hover {
    text-decoration: underline;
}
.searchForm{
      border-radius:5px;
      -moz-border-radius:5px;
      -webkit-border-radius:5px;
      width: 900px;
   }
#search_results{
      display: table; margin:0 auto;
   }
</style>
</style>

    

<!-- start custom head snippets -->

<link href="https://xrdocs.github.io/telemetry/assets/css/lity.min.css" rel="stylesheet">
<link href="https://xrdocs.github.io/telemetry/assets/css/cisco-sans.min.css" rel="stylesheet">
<link href="https://xrdocs.github.io/telemetry/assets/css/material-scrolltop.css" rel="stylesheet">

<link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://xrdocs.github.io/telemetry/images/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://xrdocs.github.io/telemetry/images/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://xrdocs.github.io/telemetry/images/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://xrdocs.github.io/telemetry/images/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://xrdocs.github.io/telemetry/images/apple-touch-icon-60x60.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://xrdocs.github.io/telemetry/images/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://xrdocs.github.io/telemetry/images/apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://xrdocs.github.io/telemetry/images/apple-touch-icon-152x152.png" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/telemetry/images/favicon-196x196.png" sizes="196x196" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/telemetry/images/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/telemetry/images/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/telemetry/images/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="https://xrdocs.github.io/telemetry/images/favicon-128.png" sizes="128x128" />
<link rel="shortcut icon" href="https://xrdocs.github.io/telemetry/images/favicon_cisco.ico" />
<meta name="application-name" content="&nbsp;"/>
<meta name="msapplication-TileColor" content="#FFFFFF" />
<meta name="msapplication-TileImage" content="https://xrdocs.github.io/telemetry/images/mstile-144x144.png" />
<meta name="msapplication-square70x70logo" content="https://xrdocs.github.io/telemetry/images/mstile-70x70.png" />
<meta name="msapplication-square150x150logo" content="https://xrdocs.github.io/telemetry/images/mstile-150x150.png" />
<meta name="msapplication-wide310x150logo" content="https://xrdocs.github.io/telemetry/images/mstile-310x150.png" />
<meta name="msapplication-square310x310logo" content="https://xrdocs.github.io/telemetry/images/mstile-310x310.png" />


<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu" style="padding-left:2em;">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <img src="https://xrdocs.github.io/telemetry/images/xrdocs_logo.png" width="45px" height="45px" alt="xrdocs logo" style="float:left;">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://xrdocs.github.io">@xrdocs</a></li>
          <li class="masthead__menu-item"><a href="https://xrdocs.github.io/telemetry/">Telemetry</a></li>
          
            
            
                
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/telemetry/blogs/">Blogs</a></li>
                
            


          
            
            
                
                    <li class="masthead__menu-item greedy-nav-active"><a href="https://xrdocs.github.io/telemetry/tutorials/">Tutorials</a></li>
                
            


          
            
            
                
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/telemetry/search">Search <i class="fa fa-search" aria-hidden="true"></i></a></li>
                
            


          
            
            
                
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/telemetry/tags/">Tags</a></li>
                
            


          
            
            
                
                    <li class="masthead__menu-item"><a href="https://xrdocs.github.io/telemetry/collection-archive/">Archive</a></li>
                
            


          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    




<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="https://xrdocs.github.io/telemetry/images/avatars/scadora16.jpeg" class="author__avatar" alt="Shelly Cadora">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Shelly Cadora</h3>
    <p class="author__bio">Principal Technical Marketing Engineer, Cisco</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
      
      
        <li><a href="mailto:scadora@cisco.com"><i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email</a></li>
      
      
      
        <li><a href="http://twitter.com/scadora"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      
      
      
      
      
      
      
      
      
        <li><a href="http://github.com/scadora"><i class="fa fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Using Pipeline: Integrating with InfluxDB">
    <meta itemprop="description" content="Describes how to configure Pipeline to relay telemetry data to InfluxDB.">
    <meta itemprop="datePublished" content="April 10, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Using Pipeline: Integrating with InfluxDB
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  6 minutes read
</p>
          
        </header>
      

    
      
        





<div class="breadcrumbs">
  <ol itemscope itemtype="http://schema.org/BreadcrumbList" style="margin:0;padding:0;">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" style="margin:0;padding:0;">
          <a href="https://xrdocs.github.io/telemetry/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" style="margin:0;padding:0;">
          <a href="https://xrdocs.github.io/telemetry/tutorials" itemprop="item"><span itemprop="name">Tutorials</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current" style="margin:0;padding:0;">Using Pipeline: Integrating with InfluxDB</li>
      
    
  </ol>
</div>

      
    


      <section class="page__content" itemprop="text">

        <aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-table"></i> Integrating Pipeline with InfluxDB</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#using-pipeline" id="markdown-toc-using-pipeline">Using Pipeline</a>    <ul>
      <li><a href="#preparing-the-router" id="markdown-toc-preparing-the-router">Preparing the Router</a></li>
      <li><a href="#getting-influxdb" id="markdown-toc-getting-influxdb">Getting Influxdb</a></li>
      <li><a href="#getting-pipeline" id="markdown-toc-getting-pipeline">Getting Pipeline</a></li>
      <li><a href="#pipelineconf" id="markdown-toc-pipelineconf">Pipeline.conf</a></li>
      <li><a href="#running-pipeline" id="markdown-toc-running-pipeline">Running Pipeline</a></li>
      <li><a href="#seeing-the-data-before-it-goes-to-influxdb" id="markdown-toc-seeing-the-data-before-it-goes-to-influxdb">Seeing the Data Before It Goes To InfluxDB</a></li>
      <li><a href="#influxdb" id="markdown-toc-influxdb">InfluxDB</a></li>
      <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
    </ul>
  </li>
</ul>

  </nav>
</aside>

<h2 id="using-pipeline">Using Pipeline</h2>

<p>In an <a href="https://xrdocs.github.io/telemetry/tutorials/2016-10-03-pipeline-to-text-tutorial/">earlier blog</a>, I discussed how to configure <a href="http://blogs.cisco.com/sp/introducing-pipeline-a-model-driven-telemetry-collection-service">Pipeline</a> to write Model-Driven-Telemetry (MDT) data to a plain text file. In this tutorial, I’ll describe the Pipeline configuration that enables you to write telemetry data into <a href="https://www.influxdata.com/">InfluxDB</a>, an open source platform for time-series data.</p>

<p>Here’s a picture of what we are trying to do:
<img src="/telemetry/images/PipelinetoInflux2.png" alt="RouterToPipelineToInfluxdb" /></p>

<p>Pipeline and InfluxDB can run on the same server or on different servers, as long as there is connectivity between them.</p>

<h3 id="preparing-the-router">Preparing the Router</h3>

<p>This tutorial assumes that you’ve already configured your router for model-driven telemetry (MDT) with TCP dial-out using the instructions in <a href="https://xrdocs.github.io/telemetry/tutorials/2016-07-21-configuring-model-driven-telemetry-mdt/">this tutorial</a>. The IP address and port that you specify in the destination-group in the router config should match the IP address and port on which Pipeline is listening.</p>

<h3 id="getting-influxdb">Getting Influxdb</h3>

<p>This tutorial assumes that you have a working instance of InfluxDB with an IP address that is accessible from your Pipeline instance and has a database named “mdt_db”.   If you want to use a different database name, edit the <code class="highlighter-rouge">pipeline.conf</code> output stage configuration below.</p>

<p>InfluxDB is available from <a href="https://github.com/influxdata/influxdb">github</a> and includes documentation on <a href="https://github.com/influxdata/influxdb#create-your-first-database">creating databases</a>.  InfluxDB is also available as a <a href="https://hub.docker.com/_/influxdb/">Docker container</a>.</p>

<h3 id="getting-pipeline">Getting Pipeline</h3>

<p>Pipeline is available from <a href="https://github.com/cisco/bigmuddy-network-telemetry-pipeline">github</a>.</p>

<h3 id="pipelineconf">Pipeline.conf</h3>

<h4 id="configuring-the-input-stage-for-tcp-dial-out">Configuring the Input Stage for TCP Dial-Out</h4>

<p>For this tutorial, I’ll use the default pipeline.conf input stage for MDT TCP Dial-Out described in the <a href="https://xrdocs.github.io/telemetry/tutorials/2016-07-21-configuring-model-driven-telemetry-mdt/">TCP to Textfile tutorial</a>.  If you take out all the comments, this reduces to 5 lines in pipeline.conf:</p>

<div class="notice--warning">

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[testbed]
stage = xport_input
type = tcp
encap = st
listen = :5432
</code></pre></div></div>

</div>

<p>This <code class="highlighter-rouge">[testbed]</code> section shown above will work “as is” for MDT with TCP dial-out.  If you want to change the port that Pipeline listens on to something other than “5432”, you can edit this section of the pipeline.conf.  Otherwise, we’re good to go for the input stage.</p>

<h4 id="configuring-the-output-stage-for-influxdb">Configuring the Output Stage for InfluxDB</h4>

<p>To push the data to InfluxDB, we need a “metrics” output stage in Pipeline.  The default pipeline.conf file comes with an example metrics stage section called <code class="highlighter-rouge">[mymetrics]</code>.  Taking out the comments, the important lines are as follows:</p>

<div class="notice--warning">

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[mymetrics]
stage = xport_output
type = metrics
file = metrics.json
dump = metricsdump.txt
output = influx
influx = http://10.152.176.74:8086
database = mdt_db
</code></pre></div></div>

</div>

<p>This configuration instructs Pipeline to post MDT data to an InfluxDB instance at 10.152.176.74:8086 that has a database named <code class="highlighter-rouge">mdt_db</code>.</p>

<p>Before posting the data to influxdb, pipeline transforms the data according to the instructions in the <code class="highlighter-rouge">metrics.json</code> file.  More on this in the next section.</p>

<p>Finally, the <code class="highlighter-rouge">dump = metricsdump.txt</code> option lets you locally dump a copy of the same data that is being pushed to influxdb.  This is useful for first-time setup and debugging.</p>

<h4 id="using-metricsjson">Using metrics.json<a name="metrics.json"></a></h4>

<p><strong>TL;DR</strong> If you are using the sensor-path from the <a href="https://xrdocs.github.io/telemetry/tutorials/2016-07-21-configuring-model-driven-telemetry-mdt/">TCP to Textfile tutorial</a> and the default metrics.json, you actually have nothing to do.  But if you have a burning desire to know <em>how</em> things works, please read the rest of the section!</p>

<p>YANG models define data hierarchies.  Because MDT is based on YANG models, the raw telemetry data from a router is also hierarchical.  Time-series databases, however, typically expect data in a simple format: metric name, metric value, timestamp and, optionally, some tags or keys.  In influxdb, this format is called the “Line Protocol.”</p>

<p>One of the important functions of Pipeline is to take the hierarchical YANG-based data and transform it into the Line Protocol for easy consumption by influxdb.  Pipeline takes the complex, hierarchical YANG-modeled data and flattens it into multiple time series.  Pipeline uses the <code class="highlighter-rouge">metrics.json</code> file to perform the transformation. The <code class="highlighter-rouge">metrics.json</code> file contains a series of json objects, one for each YANG model and sub-tree path that the router streams.</p>

<p>Take the sensor-path configured on the router in the <a href="https://xrdocs.github.io/telemetry/tutorials/2016-07-21-configuring-model-driven-telemetry-mdt/">TCP Dial Out Tutorial</a>: <code class="highlighter-rouge">Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters</code>.  The corresponding object in the default metrics.json is below:</p>

<div class="notice--warning">

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
		"basepath" : "Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters",
		"spec" : {
			"fields" : [
				{"name" : "interface-name", "tag" : true},
				{"name" : "packets-received"},
				{"name" : "bytes-received"},
				{"name" : "packets-sent"},
				{"name" : "bytes-sent"},
				{"name" : "output-drops"},
				{"name" : "output-queue-drops"},
				{"name" : "input-drops"},
				{"name" : "input-queue-drops"},
				{"name" : "input-errors"},
				{"name" : "crc-errors"},
				{"name" : "input-ignored-packets"},
				{"name" : "output-errors"},
				{"name" : "output-buffer-failures"},
				{"name" : "carrier-transitions"}
			]
		}
	}
</code></pre></div></div>

</div>

<p>This entry in the metrics.json file enables Pipeline to post interface statistics in the influxdb Line Protocol with the following characteristics:</p>

<p>Measurement:</p>
<ul>
  <li>Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters</li>
</ul>

<p>Tag Names and Values</p>
<ul>
  <li>EncodingPath=Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counter</li>
  <li>Producer=SunC</li>
  <li>interface-name=MgmtEth0/RP0/CPU0/0</li>
</ul>

<p>Field Keys and Values</p>
<ul>
  <li>bytes-received=307428735</li>
  <li>bytes-sent=23017070265</li>
  <li>
    <etc>

</etc>
  </li>
</ul>
<p>Timestamp</p>
<ul>
  <li>1491942788950000000</li>
</ul>

<p>You might have noticed that “interface-name” is one of the Tag Names, not a Field Key above. There are two ways to get an MDT metric marked as a Tag.  First, recall that the router sends MDT data as one of two types: Keys and Content.  Pipeline will automatically translate items in the MDT Keys section to a Tag.  You can also use the metrics.json file.  Any entry in the metrics.json file with <code class="highlighter-rouge">"tag" : true</code> will be added to the Tag Names in the Line Protocol and not sent as a Field Key.</p>

<p>Also good to know: if you don’t have an entry in the metrics.json file, then that data point will not be posted to InfluxDB, even if the router sends that data to Pipeline.  That’s actually a feature!  Because bulk data collection is more efficient for the router, the router streams data at the container level of the YANG model.  That means you will sometimes receive more data than you actually need.  Pipeline gives you the ability to filter what data gets passed on to your time series database.</p>

<p>Final takeaway, if the path you are streaming is already described in the metrics.json and has all the fields you care about (as is this case here), there is nothing to do.  Adding objects to the metrics.json will be the topic of a future tutorial.</p>

<h3 id="running-pipeline">Running Pipeline</h3>

<p>Run pipeline as usual, by executing the binary in the bin directory. Pipeline will use the pipeline.conf file by default.  Pipeline will prompt you for credentials to use when posting to influxdb.</p>

<div class="notice--warning">

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scadora@darcy:~/bigmuddy-network-telemetry-pipeline$ bin/pipeline
Startup pipeline
Load config from [pipeline.conf], logging in [pipeline.log]

CRYPT Client [mymetrics],[http://10.152.176.84:8086]
 Enter username: admin
 Enter password:
Wait for ^C to shutdown
</code></pre></div></div>

</div>

<p>Power users will appreciate the <code class="highlighter-rouge">-log= -debug</code> option for pipeline:</p>

<div class="notice--warning">

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scadora@darcy:~/bigmuddy-network-telemetry-pipeline$ bin/pipeline -log= -debug
INFO[2017-04-12 14:41:05.038501] Conductor says hello, loading config          config=pipeline.conf debug=true fluentd= logfile= maxthreads=1 tag=pipeline version="v1.0.0(bigmuddy)"
DEBU[2017-04-12 14:41:05.039562] Conductor processing section...               name=conductor section=inspector tag=pipeline
DEBU[2017-04-12 14:41:05.039690] Conductor processing section, type...         name=conductor section=inspector tag=pipeline type=tap
INFO[2017-04-12 14:41:05.039800] Conductor starting up section                 name=conductor section=inspector stage="xport_output" tag=pipeline
DEBU[2017-04-12 14:41:05.039887] Conductor processing section...               name=conductor section=mymetrics tag=pipeline
DEBU[2017-04-12 14:41:05.039940] Conductor processing section, type...         name=conductor section=mymetrics tag=pipeline type=metrics
INFO[2017-04-12 14:41:05.039982] Conductor starting up section                 name=conductor section=mymetrics stage="xport_output" tag=pipeline
&lt;output snipped for brevity&gt;
</code></pre></div></div>

</div>

<h3 id="seeing-the-data-before-it-goes-to-influxdb">Seeing the Data Before It Goes To InfluxDB</h3>

<p>Since we configure a “dump” file in the <code class="highlighter-rouge">[mymetrics]</code> output stage above, Pipeline will dump a local copy of the data it posts to InfluxDB into a text file in the Line Protocol format.  This is a good way to confirm that Pipeline is receiving data from the router and parsing it with a valid <code class="highlighter-rouge">metrics.json</code> entry.</p>

<div class="notice--warning">

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scadora@darcy:~/bigmuddy-network-telemetry-pipeline$ tail -f metricsdump.txt_wkid0
Server: [http://10.152.176.84:8086], wkid 0, writing 7 points in db: mdt_db
(prec: [ms], consistency: [], retention: [])
	Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters,EncodingPath=Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters,Producer=SunC,interface-name=Bundle-Ether1 bytes-received=175069849,bytes-sent=9057828,carrier-transitions=0i,crc-errors=0i,input-drops=0i,input-errors=0i,input-ignored-packets=0i,input-queue-drops=0i,output-buffer-failures=0i,output-drops=0i,output-errors=0i,output-queue-drops=0i,packets-received=1189543,packets-sent=103020 1491943978355000000
	Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters,EncodingPath=Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters,Producer=SunC,interface-name=Null0 bytes-received=0,bytes-sent=0,carrier-transitions=0i,crc-errors=0i,input-drops=0i,input-errors=0i,input-ignored-packets=0i,input-queue-drops=0i,output-buffer-failures=0i,output-drops=0i,output-errors=0i,output-queue-drops=0i,packets-received=0,packets-sent=0 1491943978355000000
	Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters,EncodingPath=Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters,Producer=SunC,interface-name=MgmtEth0/RP0/CPU0/0 bytes-received=307431285,bytes-sent=23017071885,carrier-transitions=1i,crc-errors=0i,input-drops=139i,input-errors=0i,input-ignored-packets=0i,input-queue-drops=0i,output-buffer-failures=0i,output-drops=0i,output-errors=0i,output-queue-drops=0i,packets-received=4338703,packets-sent=16808000 1491943978355000000
</code></pre></div></div>

</div>

<h3 id="influxdb">InfluxDB</h3>

<p>To validate that the data has been received by influxdb, you can use curl to query the database:</p>

<div class="notice--warning">

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ curl -G 'http://localhost:8086/query?pretty=true' --data-urlencode "db=mdt_db" --data-urlencode "q=SELECT \"bytes-sent\" FROM \"Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters\" WHERE \"interface-name\"='GigabitEthernet0/0/0/0'"
{
    "results": [
        {
            "series": [
                {
                    "name": "Cisco-IOS-XR-infra-statsd-oper:infra-statistics/interfaces/interface/latest/generic-counters",
                    "columns": [
                        "time",
                        "bytes-sent"
                    ],
                    "values": [
                        [
                            "2017-04-11T21:04:57.205Z",
                            1.911903356e+09
                        ],
                        [
                            "2017-04-11T21:05:27.214Z",
                            1.911903356e+09
                        ],
                        [
                            "2017-04-11T21:05:57.226Z",
                            1.911911181e+09
                        ]
                    ]
                }
            ]
        }
    ]
}
</code></pre></div></div>

</div>

<p>If you are using <a href="https://grafana.com/">grafana</a> to query and visualize your influxdb data, you can use all the queries and dashboards you know and love, as in this simple graph of packets sent on Gigabit Ethernet 0/0/0/0:</p>

<p><img src="/telemetry/images/basic_influxdb.png" alt="basic_influxdb.png" /></p>

<p>For those hearty souls who slogged through the <a href="#metrics.json">Using metrics.json</a> section, note that we could use <code class="highlighter-rouge">interface-name</code> in the Where clause of the query above because it was sent as a Tag in the Line Protocol.</p>

<h3 id="conclusion">Conclusion</h3>
<p>Pipeline gives you a easy, flexible way to get data into commonly used open-source tools like influxdb.  Give it a try and let us know what you think!</p>


        
      </section>

      <footer class="page__meta">
        
        




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://xrdocs.github.io/telemetry/tags/#iosxr" class="page__taxonomy-item" rel="tag">iosxr</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.github.io/telemetry/tags/#mdt" class="page__taxonomy-item" rel="tag">MDT</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.github.io/telemetry/tags/#pipeline" class="page__taxonomy-item" rel="tag">pipeline</a><span class="sep">, </span>
    
      
      
      <a href="https://xrdocs.github.io/telemetry/tags/#telemetry" class="page__taxonomy-item" rel="tag">telemetry</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-04-10T20:19:00+00:00">April 10, 2017</time></p>
        
      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=https://xrdocs.github.io/telemetry/tutorials/2017-04-10-using-pipeline-integrating-with-influxdb/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://xrdocs.github.io/telemetry/tutorials/2017-04-10-using-pipeline-integrating-with-influxdb/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://xrdocs.github.io/telemetry/tutorials/2017-04-10-using-pipeline-integrating-with-influxdb/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://xrdocs.github.io/telemetry/tutorials/2017-04-10-using-pipeline-integrating-with-influxdb/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>

    <br>
    <br>
    <br>
</section>


    </div>

    
      

<div class="page__comments">
  <h4 class="page__comments-title">Leave a Comment</h4>
  
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/xrdocs"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/xrdocs"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://xrdocs.github.io/telemetry/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Cisco Systems Inc. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="https://xrdocs.github.io/telemetry/assets/js/main.min.js"></script>
<script src="https://xrdocs.github.io/telemetry/assets/js/scrollmenu.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-78256516-1', 'auto');
  ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'xrdocs';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






<!-- material-scrolltop button -->
<button class="material-scrolltop" type="button"></button>

<!-- material-scrolltop plugin -->
<script src="https://xrdocs.github.io/telemetry/assets/js/material-scrolltop.js"></script>

<!-- Initialize material-scrolltop with (minimal) -->
<script>
    $('body').materialScrollTop();
</script>


  </body>
</html>

